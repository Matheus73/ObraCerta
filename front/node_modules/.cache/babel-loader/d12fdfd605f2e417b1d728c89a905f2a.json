{"ast":null,"code":"function _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nimport { now, timer, timeout } from 'd3-timer';\nimport { timingDefaults, extend, getTransitionId, isNamespace } from './utils';\nimport Events from './Events';\n\nvar BaseNode = function () {\n  function BaseNode(state) {\n    _classCallCheck(this, BaseNode);\n\n    this.state = state || {};\n  }\n\n  _createClass(BaseNode, [{\n    key: \"transition\",\n    value: function transition(config) {\n      if (Array.isArray(config)) {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = config[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var item = _step.value;\n            this.parse(item);\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n      } else {\n        this.parse(config);\n      }\n    }\n  }, {\n    key: \"isTransitioning\",\n    value: function isTransitioning() {\n      return !!this.transitionData;\n    }\n  }, {\n    key: \"stopTransitions\",\n    value: function stopTransitions() {\n      var transitions = this.transitionData;\n\n      if (transitions) {\n        Object.keys(transitions).forEach(function (t) {\n          transitions[t].timer.stop();\n        });\n      }\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(update) {\n      if (typeof update === 'function') {\n        extend(this.state, update(this.state));\n      } else {\n        extend(this.state, update);\n      }\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(config) {\n      var _this = this;\n\n      var clone = _objectSpread({}, config);\n\n      var events = new Events(clone);\n\n      if (clone.events) {\n        delete clone.events;\n      }\n\n      var timing = _objectSpread({}, timingDefaults, clone.timing || {}, {\n        time: now()\n      });\n\n      if (clone.timing) {\n        delete clone.timing;\n      }\n\n      Object.keys(clone).forEach(function (stateKey) {\n        var tweens = [];\n        var next = clone[stateKey];\n\n        if (isNamespace(next)) {\n          Object.keys(next).forEach(function (attr) {\n            var val = next[attr];\n\n            if (Array.isArray(val)) {\n              if (val.length === 1) {\n                tweens.push(_this.getTween(attr, val[0], stateKey));\n              } else {\n                _this.setState(function (state) {\n                  var _objectSpread2, _ref;\n\n                  return _ref = {}, _ref[stateKey] = _objectSpread({}, state[stateKey], (_objectSpread2 = {}, _objectSpread2[attr] = val[0], _objectSpread2)), _ref;\n                });\n\n                tweens.push(_this.getTween(attr, val[1], stateKey));\n              }\n            } else if (typeof val === 'function') {\n              var getNameSpacedCustomTween = function getNameSpacedCustomTween() {\n                var kapellmeisterNamespacedTween = function kapellmeisterNamespacedTween(t) {\n                  _this.setState(function (state) {\n                    var _objectSpread3, _ref2;\n\n                    return _ref2 = {}, _ref2[stateKey] = _objectSpread({}, state[stateKey], (_objectSpread3 = {}, _objectSpread3[attr] = val(t), _objectSpread3)), _ref2;\n                  });\n                };\n\n                return kapellmeisterNamespacedTween;\n              };\n\n              tweens.push(getNameSpacedCustomTween);\n            } else {\n              _this.setState(function (state) {\n                var _objectSpread4, _ref3;\n\n                return _ref3 = {}, _ref3[stateKey] = _objectSpread({}, state[stateKey], (_objectSpread4 = {}, _objectSpread4[attr] = val, _objectSpread4)), _ref3;\n              });\n\n              tweens.push(_this.getTween(attr, val, stateKey));\n            }\n          });\n        } else {\n          if (Array.isArray(next)) {\n            if (next.length === 1) {\n              tweens.push(_this.getTween(stateKey, next[0], null));\n            } else {\n              var _this$setState;\n\n              _this.setState((_this$setState = {}, _this$setState[stateKey] = next[0], _this$setState));\n\n              tweens.push(_this.getTween(stateKey, next[1], null));\n            }\n          } else if (typeof next === 'function') {\n            var getCustomTween = function getCustomTween() {\n              var kapellmeisterTween = function kapellmeisterTween(t) {\n                var _this$setState2;\n\n                _this.setState((_this$setState2 = {}, _this$setState2[stateKey] = next(t), _this$setState2));\n              };\n\n              return kapellmeisterTween;\n            };\n\n            tweens.push(getCustomTween);\n          } else {\n            var _this$setState3;\n\n            _this.setState((_this$setState3 = {}, _this$setState3[stateKey] = next, _this$setState3));\n\n            tweens.push(_this.getTween(stateKey, next, null));\n          }\n        }\n\n        _this.update({\n          stateKey: stateKey,\n          timing: timing,\n          tweens: tweens,\n          events: events,\n          status: 0\n        });\n      });\n    }\n  }, {\n    key: \"getTween\",\n    value: function getTween(attr, endValue, nameSpace) {\n      var _this2 = this;\n\n      return function () {\n        var begValue = nameSpace ? _this2.state[nameSpace][attr] : _this2.state[attr];\n\n        if (begValue === endValue) {\n          return null;\n        }\n\n        var i = _this2.getInterpolator(begValue, endValue, attr, nameSpace);\n\n        var stateTween;\n\n        if (nameSpace === null) {\n          stateTween = function stateTween(t) {\n            var _this2$setState;\n\n            _this2.setState((_this2$setState = {}, _this2$setState[attr] = i(t), _this2$setState));\n          };\n        } else {\n          stateTween = function stateTween(t) {\n            _this2.setState(function (state) {\n              var _objectSpread5, _ref4;\n\n              return _ref4 = {}, _ref4[nameSpace] = _objectSpread({}, state[nameSpace], (_objectSpread5 = {}, _objectSpread5[attr] = i(t), _objectSpread5)), _ref4;\n            });\n          };\n        }\n\n        return stateTween;\n      };\n    }\n  }, {\n    key: \"update\",\n    value: function update(transition) {\n      if (!this.transitionData) {\n        this.transitionData = {};\n      }\n\n      this.init(getTransitionId(), transition);\n    }\n  }, {\n    key: \"init\",\n    value: function init(id, transition) {\n      var _this3 = this;\n\n      var n = transition.tweens.length;\n      var tweens = new Array(n);\n\n      var queue = function queue(elapsed) {\n        transition.status = 1;\n        transition.timer.restart(start, transition.timing.delay, transition.timing.time);\n\n        if (transition.timing.delay <= elapsed) {\n          start(elapsed - transition.timing.delay);\n        }\n      };\n\n      this.transitionData[id] = transition;\n      transition.timer = timer(queue, 0, transition.timing.time);\n\n      var start = function start(elapsed) {\n        if (transition.status !== 1) return stop();\n\n        for (var tid in _this3.transitionData) {\n          var t = _this3.transitionData[tid];\n\n          if (t.stateKey !== transition.stateKey) {\n            continue;\n          }\n\n          if (t.status === 3) {\n            return timeout(start);\n          }\n\n          if (t.status === 4) {\n            t.status = 6;\n            t.timer.stop();\n\n            if (t.events.interrupt) {\n              t.events.interrupt.call(_this3);\n            }\n\n            delete _this3.transitionData[tid];\n          } else if (+tid < id) {\n            t.status = 6;\n            t.timer.stop();\n            delete _this3.transitionData[tid];\n          }\n        }\n\n        timeout(function () {\n          if (transition.status === 3) {\n            transition.status = 4;\n            transition.timer.restart(tick, transition.timing.delay, transition.timing.time);\n            tick(elapsed);\n          }\n        });\n        transition.status = 2;\n\n        if (transition.events.start) {\n          transition.events.start.call(_this3);\n        }\n\n        if (transition.status !== 2) {\n          return;\n        }\n\n        transition.status = 3;\n        var j = -1;\n\n        for (var i = 0; i < n; ++i) {\n          var res = transition.tweens[i]();\n\n          if (res) {\n            tweens[++j] = res;\n          }\n        }\n\n        tweens.length = j + 1;\n      };\n\n      var tick = function tick(elapsed) {\n        var t = 1;\n\n        if (elapsed < transition.timing.duration) {\n          t = transition.timing.ease(elapsed / transition.timing.duration);\n        } else {\n          transition.timer.restart(stop);\n          transition.status = 5;\n        }\n\n        var i = -1;\n\n        while (++i < tweens.length) {\n          tweens[i](t);\n        }\n\n        if (transition.status === 5) {\n          if (transition.events.end) {\n            transition.events.end.call(_this3);\n          }\n\n          stop();\n        }\n      };\n\n      var stop = function stop() {\n        transition.status = 6;\n        transition.timer.stop();\n        delete _this3.transitionData[id];\n\n        for (var _ in _this3.transitionData) {\n          return;\n        }\n\n        delete _this3.transitionData;\n      };\n    }\n  }]);\n\n  return BaseNode;\n}();\n\nexport default BaseNode;","map":{"version":3,"sources":["/home/bebeto/Documentos/MDS/ObraCerta/front/node_modules/kapellmeister/es/BaseNode.js"],"names":["_objectSpread","target","i","arguments","length","source","ownKeys","Object","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","prototype","now","timer","timeout","timingDefaults","extend","getTransitionId","isNamespace","Events","BaseNode","state","transition","config","Array","isArray","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_iterator","Symbol","iterator","_step","next","done","item","parse","err","return","isTransitioning","transitionData","stopTransitions","transitions","t","stop","setState","update","_this","clone","events","timing","time","stateKey","tweens","attr","val","push","getTween","_objectSpread2","_ref","getNameSpacedCustomTween","kapellmeisterNamespacedTween","_objectSpread3","_ref2","_objectSpread4","_ref3","_this$setState","getCustomTween","kapellmeisterTween","_this$setState2","_this$setState3","status","endValue","nameSpace","_this2","begValue","getInterpolator","stateTween","_this2$setState","_objectSpread5","_ref4","init","id","_this3","n","queue","elapsed","restart","start","delay","tid","interrupt","call","tick","j","res","duration","ease","end","_"],"mappings":"AAAA,SAASA,aAAT,CAAuBC,MAAvB,EAA+B;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAT,IAAgB,IAAhB,GAAuBC,SAAS,CAACD,CAAD,CAAhC,GAAsC,EAAnD;AAAuD,QAAII,OAAO,GAAGC,MAAM,CAACC,IAAP,CAAYH,MAAZ,CAAd;;AAAmC,QAAI,OAAOE,MAAM,CAACE,qBAAd,KAAwC,UAA5C,EAAwD;AAAEH,MAAAA,OAAO,GAAGA,OAAO,CAACI,MAAR,CAAeH,MAAM,CAACE,qBAAP,CAA6BJ,MAA7B,EAAqCM,MAArC,CAA4C,UAAUC,GAAV,EAAe;AAAE,eAAOL,MAAM,CAACM,wBAAP,CAAgCR,MAAhC,EAAwCO,GAAxC,EAA6CE,UAApD;AAAiE,OAA9H,CAAf,CAAV;AAA4J;;AAACR,IAAAA,OAAO,CAACS,OAAR,CAAgB,UAAUC,GAAV,EAAe;AAAEC,MAAAA,eAAe,CAAChB,MAAD,EAASe,GAAT,EAAcX,MAAM,CAACW,GAAD,CAApB,CAAf;AAA4C,KAA7E;AAAiF;;AAAC,SAAOf,MAAP;AAAgB;;AAEje,SAASgB,eAAT,CAAyBC,GAAzB,EAA8BF,GAA9B,EAAmCG,KAAnC,EAA0C;AAAE,MAAIH,GAAG,IAAIE,GAAX,EAAgB;AAAEX,IAAAA,MAAM,CAACa,cAAP,CAAsBF,GAAtB,EAA2BF,GAA3B,EAAgC;AAAEG,MAAAA,KAAK,EAAEA,KAAT;AAAgBL,MAAAA,UAAU,EAAE,IAA5B;AAAkCO,MAAAA,YAAY,EAAE,IAAhD;AAAsDC,MAAAA,QAAQ,EAAE;AAAhE,KAAhC;AAA0G,GAA5H,MAAkI;AAAEJ,IAAAA,GAAG,CAACF,GAAD,CAAH,GAAWG,KAAX;AAAmB;;AAAC,SAAOD,GAAP;AAAa;;AAEjN,SAASK,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAAE,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIC,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASC,iBAAT,CAA2B1B,MAA3B,EAAmC2B,KAAnC,EAA0C;AAAE,OAAK,IAAI1B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0B,KAAK,CAACxB,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AAAE,QAAI2B,UAAU,GAAGD,KAAK,CAAC1B,CAAD,CAAtB;AAA2B2B,IAAAA,UAAU,CAACf,UAAX,GAAwBe,UAAU,CAACf,UAAX,IAAyB,KAAjD;AAAwDe,IAAAA,UAAU,CAACR,YAAX,GAA0B,IAA1B;AAAgC,QAAI,WAAWQ,UAAf,EAA2BA,UAAU,CAACP,QAAX,GAAsB,IAAtB;AAA4Bf,IAAAA,MAAM,CAACa,cAAP,CAAsBnB,MAAtB,EAA8B4B,UAAU,CAACb,GAAzC,EAA8Ca,UAA9C;AAA4D;AAAE;;AAE7T,SAASC,YAAT,CAAsBL,WAAtB,EAAmCM,UAAnC,EAA+CC,WAA/C,EAA4D;AAAE,MAAID,UAAJ,EAAgBJ,iBAAiB,CAACF,WAAW,CAACQ,SAAb,EAAwBF,UAAxB,CAAjB;AAAsD,MAAIC,WAAJ,EAAiBL,iBAAiB,CAACF,WAAD,EAAcO,WAAd,CAAjB;AAA6C,SAAOP,WAAP;AAAqB;;AAEvN,SAASS,GAAT,EAAcC,KAAd,EAAqBC,OAArB,QAAoC,UAApC;AACA,SAASC,cAAT,EAAyBC,MAAzB,EAAiCC,eAAjC,EAAkDC,WAAlD,QAAqE,SAArE;AACA,OAAOC,MAAP,MAAmB,UAAnB;;AAEA,IAAIC,QAAQ,GAAG,YAAY;AACzB,WAASA,QAAT,CAAkBC,KAAlB,EAAyB;AACvBpB,IAAAA,eAAe,CAAC,IAAD,EAAOmB,QAAP,CAAf;;AAEA,SAAKC,KAAL,GAAaA,KAAK,IAAI,EAAtB;AACD;;AAEDb,EAAAA,YAAY,CAACY,QAAD,EAAW,CAAC;AACtB1B,IAAAA,GAAG,EAAE,YADiB;AAEtBG,IAAAA,KAAK,EAAE,SAASyB,UAAT,CAAoBC,MAApB,EAA4B;AACjC,UAAIC,KAAK,CAACC,OAAN,CAAcF,MAAd,CAAJ,EAA2B;AACzB,YAAIG,yBAAyB,GAAG,IAAhC;AACA,YAAIC,iBAAiB,GAAG,KAAxB;AACA,YAAIC,cAAc,GAAGC,SAArB;;AAEA,YAAI;AACF,eAAK,IAAIC,SAAS,GAAGP,MAAM,CAACQ,MAAM,CAACC,QAAR,CAAN,EAAhB,EAA2CC,KAAhD,EAAuD,EAAEP,yBAAyB,GAAG,CAACO,KAAK,GAAGH,SAAS,CAACI,IAAV,EAAT,EAA2BC,IAAzD,CAAvD,EAAuHT,yBAAyB,GAAG,IAAnJ,EAAyJ;AACvJ,gBAAIU,IAAI,GAAGH,KAAK,CAACpC,KAAjB;AACA,iBAAKwC,KAAL,CAAWD,IAAX;AACD;AACF,SALD,CAKE,OAAOE,GAAP,EAAY;AACZX,UAAAA,iBAAiB,GAAG,IAApB;AACAC,UAAAA,cAAc,GAAGU,GAAjB;AACD,SARD,SAQU;AACR,cAAI;AACF,gBAAI,CAACZ,yBAAD,IAA8BI,SAAS,CAACS,MAAV,IAAoB,IAAtD,EAA4D;AAC1DT,cAAAA,SAAS,CAACS,MAAV;AACD;AACF,WAJD,SAIU;AACR,gBAAIZ,iBAAJ,EAAuB;AACrB,oBAAMC,cAAN;AACD;AACF;AACF;AACF,OAxBD,MAwBO;AACL,aAAKS,KAAL,CAAWd,MAAX;AACD;AACF;AA9BqB,GAAD,EA+BpB;AACD7B,IAAAA,GAAG,EAAE,iBADJ;AAEDG,IAAAA,KAAK,EAAE,SAAS2C,eAAT,GAA2B;AAChC,aAAO,CAAC,CAAC,KAAKC,cAAd;AACD;AAJA,GA/BoB,EAoCpB;AACD/C,IAAAA,GAAG,EAAE,iBADJ;AAEDG,IAAAA,KAAK,EAAE,SAAS6C,eAAT,GAA2B;AAChC,UAAIC,WAAW,GAAG,KAAKF,cAAvB;;AAEA,UAAIE,WAAJ,EAAiB;AACf1D,QAAAA,MAAM,CAACC,IAAP,CAAYyD,WAAZ,EAAyBlD,OAAzB,CAAiC,UAAUmD,CAAV,EAAa;AAC5CD,UAAAA,WAAW,CAACC,CAAD,CAAX,CAAe/B,KAAf,CAAqBgC,IAArB;AACD,SAFD;AAGD;AACF;AAVA,GApCoB,EA+CpB;AACDnD,IAAAA,GAAG,EAAE,UADJ;AAEDG,IAAAA,KAAK,EAAE,SAASiD,QAAT,CAAkBC,MAAlB,EAA0B;AAC/B,UAAI,OAAOA,MAAP,KAAkB,UAAtB,EAAkC;AAChC/B,QAAAA,MAAM,CAAC,KAAKK,KAAN,EAAa0B,MAAM,CAAC,KAAK1B,KAAN,CAAnB,CAAN;AACD,OAFD,MAEO;AACLL,QAAAA,MAAM,CAAC,KAAKK,KAAN,EAAa0B,MAAb,CAAN;AACD;AACF;AARA,GA/CoB,EAwDpB;AACDrD,IAAAA,GAAG,EAAE,OADJ;AAEDG,IAAAA,KAAK,EAAE,SAASwC,KAAT,CAAed,MAAf,EAAuB;AAC5B,UAAIyB,KAAK,GAAG,IAAZ;;AAEA,UAAIC,KAAK,GAAGvE,aAAa,CAAC,EAAD,EAAK6C,MAAL,CAAzB;;AAEA,UAAI2B,MAAM,GAAG,IAAI/B,MAAJ,CAAW8B,KAAX,CAAb;;AAEA,UAAIA,KAAK,CAACC,MAAV,EAAkB;AAChB,eAAOD,KAAK,CAACC,MAAb;AACD;;AAED,UAAIC,MAAM,GAAGzE,aAAa,CAAC,EAAD,EAAKqC,cAAL,EAAqBkC,KAAK,CAACE,MAAN,IAAgB,EAArC,EAAyC;AACjEC,QAAAA,IAAI,EAAExC,GAAG;AADwD,OAAzC,CAA1B;;AAIA,UAAIqC,KAAK,CAACE,MAAV,EAAkB;AAChB,eAAOF,KAAK,CAACE,MAAb;AACD;;AAEDlE,MAAAA,MAAM,CAACC,IAAP,CAAY+D,KAAZ,EAAmBxD,OAAnB,CAA2B,UAAU4D,QAAV,EAAoB;AAC7C,YAAIC,MAAM,GAAG,EAAb;AACA,YAAIpB,IAAI,GAAGe,KAAK,CAACI,QAAD,CAAhB;;AAEA,YAAInC,WAAW,CAACgB,IAAD,CAAf,EAAuB;AACrBjD,UAAAA,MAAM,CAACC,IAAP,CAAYgD,IAAZ,EAAkBzC,OAAlB,CAA0B,UAAU8D,IAAV,EAAgB;AACxC,gBAAIC,GAAG,GAAGtB,IAAI,CAACqB,IAAD,CAAd;;AAEA,gBAAI/B,KAAK,CAACC,OAAN,CAAc+B,GAAd,CAAJ,EAAwB;AACtB,kBAAIA,GAAG,CAAC1E,MAAJ,KAAe,CAAnB,EAAsB;AACpBwE,gBAAAA,MAAM,CAACG,IAAP,CAAYT,KAAK,CAACU,QAAN,CAAeH,IAAf,EAAqBC,GAAG,CAAC,CAAD,CAAxB,EAA6BH,QAA7B,CAAZ;AACD,eAFD,MAEO;AACLL,gBAAAA,KAAK,CAACF,QAAN,CAAe,UAAUzB,KAAV,EAAiB;AAC9B,sBAAIsC,cAAJ,EAAoBC,IAApB;;AAEA,yBAAOA,IAAI,GAAG,EAAP,EAAWA,IAAI,CAACP,QAAD,CAAJ,GAAiB3E,aAAa,CAAC,EAAD,EAAK2C,KAAK,CAACgC,QAAD,CAAV,GAAuBM,cAAc,GAAG,EAAjB,EAAqBA,cAAc,CAACJ,IAAD,CAAd,GAAuBC,GAAG,CAAC,CAAD,CAA/C,EAAoDG,cAA3E,EAAzC,EAAsIC,IAA7I;AACD,iBAJD;;AAMAN,gBAAAA,MAAM,CAACG,IAAP,CAAYT,KAAK,CAACU,QAAN,CAAeH,IAAf,EAAqBC,GAAG,CAAC,CAAD,CAAxB,EAA6BH,QAA7B,CAAZ;AACD;AACF,aAZD,MAYO,IAAI,OAAOG,GAAP,KAAe,UAAnB,EAA+B;AACpC,kBAAIK,wBAAwB,GAAG,SAASA,wBAAT,GAAoC;AACjE,oBAAIC,4BAA4B,GAAG,SAASA,4BAAT,CAAsClB,CAAtC,EAAyC;AAC1EI,kBAAAA,KAAK,CAACF,QAAN,CAAe,UAAUzB,KAAV,EAAiB;AAC9B,wBAAI0C,cAAJ,EAAoBC,KAApB;;AAEA,2BAAOA,KAAK,GAAG,EAAR,EAAYA,KAAK,CAACX,QAAD,CAAL,GAAkB3E,aAAa,CAAC,EAAD,EAAK2C,KAAK,CAACgC,QAAD,CAAV,GAAuBU,cAAc,GAAG,EAAjB,EAAqBA,cAAc,CAACR,IAAD,CAAd,GAAuBC,GAAG,CAACZ,CAAD,CAA/C,EAAoDmB,cAA3E,EAA3C,EAAwIC,KAA/I;AACD,mBAJD;AAKD,iBAND;;AAQA,uBAAOF,4BAAP;AACD,eAVD;;AAYAR,cAAAA,MAAM,CAACG,IAAP,CAAYI,wBAAZ;AACD,aAdM,MAcA;AACLb,cAAAA,KAAK,CAACF,QAAN,CAAe,UAAUzB,KAAV,EAAiB;AAC9B,oBAAI4C,cAAJ,EAAoBC,KAApB;;AAEA,uBAAOA,KAAK,GAAG,EAAR,EAAYA,KAAK,CAACb,QAAD,CAAL,GAAkB3E,aAAa,CAAC,EAAD,EAAK2C,KAAK,CAACgC,QAAD,CAAV,GAAuBY,cAAc,GAAG,EAAjB,EAAqBA,cAAc,CAACV,IAAD,CAAd,GAAuBC,GAA5C,EAAiDS,cAAxE,EAA3C,EAAqIC,KAA5I;AACD,eAJD;;AAMAZ,cAAAA,MAAM,CAACG,IAAP,CAAYT,KAAK,CAACU,QAAN,CAAeH,IAAf,EAAqBC,GAArB,EAA0BH,QAA1B,CAAZ;AACD;AACF,WAtCD;AAuCD,SAxCD,MAwCO;AACL,cAAI7B,KAAK,CAACC,OAAN,CAAcS,IAAd,CAAJ,EAAyB;AACvB,gBAAIA,IAAI,CAACpD,MAAL,KAAgB,CAApB,EAAuB;AACrBwE,cAAAA,MAAM,CAACG,IAAP,CAAYT,KAAK,CAACU,QAAN,CAAeL,QAAf,EAAyBnB,IAAI,CAAC,CAAD,CAA7B,EAAkC,IAAlC,CAAZ;AACD,aAFD,MAEO;AACL,kBAAIiC,cAAJ;;AAEAnB,cAAAA,KAAK,CAACF,QAAN,EAAgBqB,cAAc,GAAG,EAAjB,EAAqBA,cAAc,CAACd,QAAD,CAAd,GAA2BnB,IAAI,CAAC,CAAD,CAApD,EAAyDiC,cAAzE;;AAEAb,cAAAA,MAAM,CAACG,IAAP,CAAYT,KAAK,CAACU,QAAN,CAAeL,QAAf,EAAyBnB,IAAI,CAAC,CAAD,CAA7B,EAAkC,IAAlC,CAAZ;AACD;AACF,WAVD,MAUO,IAAI,OAAOA,IAAP,KAAgB,UAApB,EAAgC;AACrC,gBAAIkC,cAAc,GAAG,SAASA,cAAT,GAA0B;AAC7C,kBAAIC,kBAAkB,GAAG,SAASA,kBAAT,CAA4BzB,CAA5B,EAA+B;AACtD,oBAAI0B,eAAJ;;AAEAtB,gBAAAA,KAAK,CAACF,QAAN,EAAgBwB,eAAe,GAAG,EAAlB,EAAsBA,eAAe,CAACjB,QAAD,CAAf,GAA4BnB,IAAI,CAACU,CAAD,CAAtD,EAA2D0B,eAA3E;AACD,eAJD;;AAMA,qBAAOD,kBAAP;AACD,aARD;;AAUAf,YAAAA,MAAM,CAACG,IAAP,CAAYW,cAAZ;AACD,WAZM,MAYA;AACL,gBAAIG,eAAJ;;AAEAvB,YAAAA,KAAK,CAACF,QAAN,EAAgByB,eAAe,GAAG,EAAlB,EAAsBA,eAAe,CAAClB,QAAD,CAAf,GAA4BnB,IAAlD,EAAwDqC,eAAxE;;AAEAjB,YAAAA,MAAM,CAACG,IAAP,CAAYT,KAAK,CAACU,QAAN,CAAeL,QAAf,EAAyBnB,IAAzB,EAA+B,IAA/B,CAAZ;AACD;AACF;;AAEDc,QAAAA,KAAK,CAACD,MAAN,CAAa;AACXM,UAAAA,QAAQ,EAAEA,QADC;AAEXF,UAAAA,MAAM,EAAEA,MAFG;AAGXG,UAAAA,MAAM,EAAEA,MAHG;AAIXJ,UAAAA,MAAM,EAAEA,MAJG;AAKXsB,UAAAA,MAAM,EAAE;AALG,SAAb;AAOD,OAnFD;AAoFD;AAzGA,GAxDoB,EAkKpB;AACD9E,IAAAA,GAAG,EAAE,UADJ;AAEDG,IAAAA,KAAK,EAAE,SAAS6D,QAAT,CAAkBH,IAAlB,EAAwBkB,QAAxB,EAAkCC,SAAlC,EAA6C;AAClD,UAAIC,MAAM,GAAG,IAAb;;AAEA,aAAO,YAAY;AACjB,YAAIC,QAAQ,GAAGF,SAAS,GAAGC,MAAM,CAACtD,KAAP,CAAaqD,SAAb,EAAwBnB,IAAxB,CAAH,GAAmCoB,MAAM,CAACtD,KAAP,CAAakC,IAAb,CAA3D;;AAEA,YAAIqB,QAAQ,KAAKH,QAAjB,EAA2B;AACzB,iBAAO,IAAP;AACD;;AAED,YAAI7F,CAAC,GAAG+F,MAAM,CAACE,eAAP,CAAuBD,QAAvB,EAAiCH,QAAjC,EAA2ClB,IAA3C,EAAiDmB,SAAjD,CAAR;;AAEA,YAAII,UAAJ;;AAEA,YAAIJ,SAAS,KAAK,IAAlB,EAAwB;AACtBI,UAAAA,UAAU,GAAG,SAASA,UAAT,CAAoBlC,CAApB,EAAuB;AAClC,gBAAImC,eAAJ;;AAEAJ,YAAAA,MAAM,CAAC7B,QAAP,EAAiBiC,eAAe,GAAG,EAAlB,EAAsBA,eAAe,CAACxB,IAAD,CAAf,GAAwB3E,CAAC,CAACgE,CAAD,CAA/C,EAAoDmC,eAArE;AACD,WAJD;AAKD,SAND,MAMO;AACLD,UAAAA,UAAU,GAAG,SAASA,UAAT,CAAoBlC,CAApB,EAAuB;AAClC+B,YAAAA,MAAM,CAAC7B,QAAP,CAAgB,UAAUzB,KAAV,EAAiB;AAC/B,kBAAI2D,cAAJ,EAAoBC,KAApB;;AAEA,qBAAOA,KAAK,GAAG,EAAR,EAAYA,KAAK,CAACP,SAAD,CAAL,GAAmBhG,aAAa,CAAC,EAAD,EAAK2C,KAAK,CAACqD,SAAD,CAAV,GAAwBM,cAAc,GAAG,EAAjB,EAAqBA,cAAc,CAACzB,IAAD,CAAd,GAAuB3E,CAAC,CAACgE,CAAD,CAA7C,EAAkDoC,cAA1E,EAA5C,EAAwIC,KAA/I;AACD,aAJD;AAKD,WAND;AAOD;;AAED,eAAOH,UAAP;AACD,OA5BD;AA6BD;AAlCA,GAlKoB,EAqMpB;AACDpF,IAAAA,GAAG,EAAE,QADJ;AAEDG,IAAAA,KAAK,EAAE,SAASkD,MAAT,CAAgBzB,UAAhB,EAA4B;AACjC,UAAI,CAAC,KAAKmB,cAAV,EAA0B;AACxB,aAAKA,cAAL,GAAsB,EAAtB;AACD;;AAED,WAAKyC,IAAL,CAAUjE,eAAe,EAAzB,EAA6BK,UAA7B;AACD;AARA,GArMoB,EA8MpB;AACD5B,IAAAA,GAAG,EAAE,MADJ;AAEDG,IAAAA,KAAK,EAAE,SAASqF,IAAT,CAAcC,EAAd,EAAkB7D,UAAlB,EAA8B;AACnC,UAAI8D,MAAM,GAAG,IAAb;;AAEA,UAAIC,CAAC,GAAG/D,UAAU,CAACgC,MAAX,CAAkBxE,MAA1B;AACA,UAAIwE,MAAM,GAAG,IAAI9B,KAAJ,CAAU6D,CAAV,CAAb;;AAEA,UAAIC,KAAK,GAAG,SAASA,KAAT,CAAeC,OAAf,EAAwB;AAClCjE,QAAAA,UAAU,CAACkD,MAAX,GAAoB,CAApB;AACAlD,QAAAA,UAAU,CAACT,KAAX,CAAiB2E,OAAjB,CAAyBC,KAAzB,EAAgCnE,UAAU,CAAC6B,MAAX,CAAkBuC,KAAlD,EAAyDpE,UAAU,CAAC6B,MAAX,CAAkBC,IAA3E;;AAEA,YAAI9B,UAAU,CAAC6B,MAAX,CAAkBuC,KAAlB,IAA2BH,OAA/B,EAAwC;AACtCE,UAAAA,KAAK,CAACF,OAAO,GAAGjE,UAAU,CAAC6B,MAAX,CAAkBuC,KAA7B,CAAL;AACD;AACF,OAPD;;AASA,WAAKjD,cAAL,CAAoB0C,EAApB,IAA0B7D,UAA1B;AACAA,MAAAA,UAAU,CAACT,KAAX,GAAmBA,KAAK,CAACyE,KAAD,EAAQ,CAAR,EAAWhE,UAAU,CAAC6B,MAAX,CAAkBC,IAA7B,CAAxB;;AAEA,UAAIqC,KAAK,GAAG,SAASA,KAAT,CAAeF,OAAf,EAAwB;AAClC,YAAIjE,UAAU,CAACkD,MAAX,KAAsB,CAA1B,EAA6B,OAAO3B,IAAI,EAAX;;AAE7B,aAAK,IAAI8C,GAAT,IAAgBP,MAAM,CAAC3C,cAAvB,EAAuC;AACrC,cAAIG,CAAC,GAAGwC,MAAM,CAAC3C,cAAP,CAAsBkD,GAAtB,CAAR;;AAEA,cAAI/C,CAAC,CAACS,QAAF,KAAe/B,UAAU,CAAC+B,QAA9B,EAAwC;AACtC;AACD;;AAED,cAAIT,CAAC,CAAC4B,MAAF,KAAa,CAAjB,EAAoB;AAClB,mBAAO1D,OAAO,CAAC2E,KAAD,CAAd;AACD;;AAED,cAAI7C,CAAC,CAAC4B,MAAF,KAAa,CAAjB,EAAoB;AAClB5B,YAAAA,CAAC,CAAC4B,MAAF,GAAW,CAAX;AACA5B,YAAAA,CAAC,CAAC/B,KAAF,CAAQgC,IAAR;;AAEA,gBAAID,CAAC,CAACM,MAAF,CAAS0C,SAAb,EAAwB;AACtBhD,cAAAA,CAAC,CAACM,MAAF,CAAS0C,SAAT,CAAmBC,IAAnB,CAAwBT,MAAxB;AACD;;AAED,mBAAOA,MAAM,CAAC3C,cAAP,CAAsBkD,GAAtB,CAAP;AACD,WATD,MASO,IAAI,CAACA,GAAD,GAAOR,EAAX,EAAe;AACpBvC,YAAAA,CAAC,CAAC4B,MAAF,GAAW,CAAX;AACA5B,YAAAA,CAAC,CAAC/B,KAAF,CAAQgC,IAAR;AACA,mBAAOuC,MAAM,CAAC3C,cAAP,CAAsBkD,GAAtB,CAAP;AACD;AACF;;AAED7E,QAAAA,OAAO,CAAC,YAAY;AAClB,cAAIQ,UAAU,CAACkD,MAAX,KAAsB,CAA1B,EAA6B;AAC3BlD,YAAAA,UAAU,CAACkD,MAAX,GAAoB,CAApB;AACAlD,YAAAA,UAAU,CAACT,KAAX,CAAiB2E,OAAjB,CAAyBM,IAAzB,EAA+BxE,UAAU,CAAC6B,MAAX,CAAkBuC,KAAjD,EAAwDpE,UAAU,CAAC6B,MAAX,CAAkBC,IAA1E;AACA0C,YAAAA,IAAI,CAACP,OAAD,CAAJ;AACD;AACF,SANM,CAAP;AAOAjE,QAAAA,UAAU,CAACkD,MAAX,GAAoB,CAApB;;AAEA,YAAIlD,UAAU,CAAC4B,MAAX,CAAkBuC,KAAtB,EAA6B;AAC3BnE,UAAAA,UAAU,CAAC4B,MAAX,CAAkBuC,KAAlB,CAAwBI,IAAxB,CAA6BT,MAA7B;AACD;;AAED,YAAI9D,UAAU,CAACkD,MAAX,KAAsB,CAA1B,EAA6B;AAC3B;AACD;;AAEDlD,QAAAA,UAAU,CAACkD,MAAX,GAAoB,CAApB;AACA,YAAIuB,CAAC,GAAG,CAAC,CAAT;;AAEA,aAAK,IAAInH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyG,CAApB,EAAuB,EAAEzG,CAAzB,EAA4B;AAC1B,cAAIoH,GAAG,GAAG1E,UAAU,CAACgC,MAAX,CAAkB1E,CAAlB,GAAV;;AAEA,cAAIoH,GAAJ,EAAS;AACP1C,YAAAA,MAAM,CAAC,EAAEyC,CAAH,CAAN,GAAcC,GAAd;AACD;AACF;;AAED1C,QAAAA,MAAM,CAACxE,MAAP,GAAgBiH,CAAC,GAAG,CAApB;AACD,OA3DD;;AA6DA,UAAID,IAAI,GAAG,SAASA,IAAT,CAAcP,OAAd,EAAuB;AAChC,YAAI3C,CAAC,GAAG,CAAR;;AAEA,YAAI2C,OAAO,GAAGjE,UAAU,CAAC6B,MAAX,CAAkB8C,QAAhC,EAA0C;AACxCrD,UAAAA,CAAC,GAAGtB,UAAU,CAAC6B,MAAX,CAAkB+C,IAAlB,CAAuBX,OAAO,GAAGjE,UAAU,CAAC6B,MAAX,CAAkB8C,QAAnD,CAAJ;AACD,SAFD,MAEO;AACL3E,UAAAA,UAAU,CAACT,KAAX,CAAiB2E,OAAjB,CAAyB3C,IAAzB;AACAvB,UAAAA,UAAU,CAACkD,MAAX,GAAoB,CAApB;AACD;;AAED,YAAI5F,CAAC,GAAG,CAAC,CAAT;;AAEA,eAAO,EAAEA,CAAF,GAAM0E,MAAM,CAACxE,MAApB,EAA4B;AAC1BwE,UAAAA,MAAM,CAAC1E,CAAD,CAAN,CAAUgE,CAAV;AACD;;AAED,YAAItB,UAAU,CAACkD,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,cAAIlD,UAAU,CAAC4B,MAAX,CAAkBiD,GAAtB,EAA2B;AACzB7E,YAAAA,UAAU,CAAC4B,MAAX,CAAkBiD,GAAlB,CAAsBN,IAAtB,CAA2BT,MAA3B;AACD;;AAEDvC,UAAAA,IAAI;AACL;AACF,OAvBD;;AAyBA,UAAIA,IAAI,GAAG,SAASA,IAAT,GAAgB;AACzBvB,QAAAA,UAAU,CAACkD,MAAX,GAAoB,CAApB;AACAlD,QAAAA,UAAU,CAACT,KAAX,CAAiBgC,IAAjB;AACA,eAAOuC,MAAM,CAAC3C,cAAP,CAAsB0C,EAAtB,CAAP;;AAEA,aAAK,IAAIiB,CAAT,IAAchB,MAAM,CAAC3C,cAArB,EAAqC;AACnC;AACD;;AAED,eAAO2C,MAAM,CAAC3C,cAAd;AACD,OAVD;AAWD;AArHA,GA9MoB,CAAX,CAAZ;;AAsUA,SAAOrB,QAAP;AACD,CA9Uc,EAAf;;AAgVA,eAAeA,QAAf","sourcesContent":["function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport { now, timer, timeout } from 'd3-timer';\nimport { timingDefaults, extend, getTransitionId, isNamespace } from './utils';\nimport Events from './Events';\n\nvar BaseNode = function () {\n  function BaseNode(state) {\n    _classCallCheck(this, BaseNode);\n\n    this.state = state || {};\n  }\n\n  _createClass(BaseNode, [{\n    key: \"transition\",\n    value: function transition(config) {\n      if (Array.isArray(config)) {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = config[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var item = _step.value;\n            this.parse(item);\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n      } else {\n        this.parse(config);\n      }\n    }\n  }, {\n    key: \"isTransitioning\",\n    value: function isTransitioning() {\n      return !!this.transitionData;\n    }\n  }, {\n    key: \"stopTransitions\",\n    value: function stopTransitions() {\n      var transitions = this.transitionData;\n\n      if (transitions) {\n        Object.keys(transitions).forEach(function (t) {\n          transitions[t].timer.stop();\n        });\n      }\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(update) {\n      if (typeof update === 'function') {\n        extend(this.state, update(this.state));\n      } else {\n        extend(this.state, update);\n      }\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(config) {\n      var _this = this;\n\n      var clone = _objectSpread({}, config);\n\n      var events = new Events(clone);\n\n      if (clone.events) {\n        delete clone.events;\n      }\n\n      var timing = _objectSpread({}, timingDefaults, clone.timing || {}, {\n        time: now()\n      });\n\n      if (clone.timing) {\n        delete clone.timing;\n      }\n\n      Object.keys(clone).forEach(function (stateKey) {\n        var tweens = [];\n        var next = clone[stateKey];\n\n        if (isNamespace(next)) {\n          Object.keys(next).forEach(function (attr) {\n            var val = next[attr];\n\n            if (Array.isArray(val)) {\n              if (val.length === 1) {\n                tweens.push(_this.getTween(attr, val[0], stateKey));\n              } else {\n                _this.setState(function (state) {\n                  var _objectSpread2, _ref;\n\n                  return _ref = {}, _ref[stateKey] = _objectSpread({}, state[stateKey], (_objectSpread2 = {}, _objectSpread2[attr] = val[0], _objectSpread2)), _ref;\n                });\n\n                tweens.push(_this.getTween(attr, val[1], stateKey));\n              }\n            } else if (typeof val === 'function') {\n              var getNameSpacedCustomTween = function getNameSpacedCustomTween() {\n                var kapellmeisterNamespacedTween = function kapellmeisterNamespacedTween(t) {\n                  _this.setState(function (state) {\n                    var _objectSpread3, _ref2;\n\n                    return _ref2 = {}, _ref2[stateKey] = _objectSpread({}, state[stateKey], (_objectSpread3 = {}, _objectSpread3[attr] = val(t), _objectSpread3)), _ref2;\n                  });\n                };\n\n                return kapellmeisterNamespacedTween;\n              };\n\n              tweens.push(getNameSpacedCustomTween);\n            } else {\n              _this.setState(function (state) {\n                var _objectSpread4, _ref3;\n\n                return _ref3 = {}, _ref3[stateKey] = _objectSpread({}, state[stateKey], (_objectSpread4 = {}, _objectSpread4[attr] = val, _objectSpread4)), _ref3;\n              });\n\n              tweens.push(_this.getTween(attr, val, stateKey));\n            }\n          });\n        } else {\n          if (Array.isArray(next)) {\n            if (next.length === 1) {\n              tweens.push(_this.getTween(stateKey, next[0], null));\n            } else {\n              var _this$setState;\n\n              _this.setState((_this$setState = {}, _this$setState[stateKey] = next[0], _this$setState));\n\n              tweens.push(_this.getTween(stateKey, next[1], null));\n            }\n          } else if (typeof next === 'function') {\n            var getCustomTween = function getCustomTween() {\n              var kapellmeisterTween = function kapellmeisterTween(t) {\n                var _this$setState2;\n\n                _this.setState((_this$setState2 = {}, _this$setState2[stateKey] = next(t), _this$setState2));\n              };\n\n              return kapellmeisterTween;\n            };\n\n            tweens.push(getCustomTween);\n          } else {\n            var _this$setState3;\n\n            _this.setState((_this$setState3 = {}, _this$setState3[stateKey] = next, _this$setState3));\n\n            tweens.push(_this.getTween(stateKey, next, null));\n          }\n        }\n\n        _this.update({\n          stateKey: stateKey,\n          timing: timing,\n          tweens: tweens,\n          events: events,\n          status: 0\n        });\n      });\n    }\n  }, {\n    key: \"getTween\",\n    value: function getTween(attr, endValue, nameSpace) {\n      var _this2 = this;\n\n      return function () {\n        var begValue = nameSpace ? _this2.state[nameSpace][attr] : _this2.state[attr];\n\n        if (begValue === endValue) {\n          return null;\n        }\n\n        var i = _this2.getInterpolator(begValue, endValue, attr, nameSpace);\n\n        var stateTween;\n\n        if (nameSpace === null) {\n          stateTween = function stateTween(t) {\n            var _this2$setState;\n\n            _this2.setState((_this2$setState = {}, _this2$setState[attr] = i(t), _this2$setState));\n          };\n        } else {\n          stateTween = function stateTween(t) {\n            _this2.setState(function (state) {\n              var _objectSpread5, _ref4;\n\n              return _ref4 = {}, _ref4[nameSpace] = _objectSpread({}, state[nameSpace], (_objectSpread5 = {}, _objectSpread5[attr] = i(t), _objectSpread5)), _ref4;\n            });\n          };\n        }\n\n        return stateTween;\n      };\n    }\n  }, {\n    key: \"update\",\n    value: function update(transition) {\n      if (!this.transitionData) {\n        this.transitionData = {};\n      }\n\n      this.init(getTransitionId(), transition);\n    }\n  }, {\n    key: \"init\",\n    value: function init(id, transition) {\n      var _this3 = this;\n\n      var n = transition.tweens.length;\n      var tweens = new Array(n);\n\n      var queue = function queue(elapsed) {\n        transition.status = 1;\n        transition.timer.restart(start, transition.timing.delay, transition.timing.time);\n\n        if (transition.timing.delay <= elapsed) {\n          start(elapsed - transition.timing.delay);\n        }\n      };\n\n      this.transitionData[id] = transition;\n      transition.timer = timer(queue, 0, transition.timing.time);\n\n      var start = function start(elapsed) {\n        if (transition.status !== 1) return stop();\n\n        for (var tid in _this3.transitionData) {\n          var t = _this3.transitionData[tid];\n\n          if (t.stateKey !== transition.stateKey) {\n            continue;\n          }\n\n          if (t.status === 3) {\n            return timeout(start);\n          }\n\n          if (t.status === 4) {\n            t.status = 6;\n            t.timer.stop();\n\n            if (t.events.interrupt) {\n              t.events.interrupt.call(_this3);\n            }\n\n            delete _this3.transitionData[tid];\n          } else if (+tid < id) {\n            t.status = 6;\n            t.timer.stop();\n            delete _this3.transitionData[tid];\n          }\n        }\n\n        timeout(function () {\n          if (transition.status === 3) {\n            transition.status = 4;\n            transition.timer.restart(tick, transition.timing.delay, transition.timing.time);\n            tick(elapsed);\n          }\n        });\n        transition.status = 2;\n\n        if (transition.events.start) {\n          transition.events.start.call(_this3);\n        }\n\n        if (transition.status !== 2) {\n          return;\n        }\n\n        transition.status = 3;\n        var j = -1;\n\n        for (var i = 0; i < n; ++i) {\n          var res = transition.tweens[i]();\n\n          if (res) {\n            tweens[++j] = res;\n          }\n        }\n\n        tweens.length = j + 1;\n      };\n\n      var tick = function tick(elapsed) {\n        var t = 1;\n\n        if (elapsed < transition.timing.duration) {\n          t = transition.timing.ease(elapsed / transition.timing.duration);\n        } else {\n          transition.timer.restart(stop);\n          transition.status = 5;\n        }\n\n        var i = -1;\n\n        while (++i < tweens.length) {\n          tweens[i](t);\n        }\n\n        if (transition.status === 5) {\n          if (transition.events.end) {\n            transition.events.end.call(_this3);\n          }\n\n          stop();\n        }\n      };\n\n      var stop = function stop() {\n        transition.status = 6;\n        transition.timer.stop();\n        delete _this3.transitionData[id];\n\n        for (var _ in _this3.transitionData) {\n          return;\n        }\n\n        delete _this3.transitionData;\n      };\n    }\n  }]);\n\n  return BaseNode;\n}();\n\nexport default BaseNode;"]},"metadata":{},"sourceType":"module"}